import React,{useState,useEffect}from"react";import QuillEditor from"../QuillEditor.js";import{showNotification}from"../showNotification.js";import{inputValidation}from"../../../../scripts/inputValidation.js";export default function AboutForm({about:t,csrf_token:e}){const[o,n]=useState(""),[a,i]=useState(null),[s,r]=useState(!1),[c,l]=useState(!0),u=t=>{i(inputValidation.about(t.trim())),n(t),l(!1)},d=async t=>{t.preventDefault();const n=inputValidation.about(o.trim());i(n),n||(l(!0),saveBtn.disabled=!0,r(!0),await fetch("/admin/about",{method:"POST",body:JSON.stringify({content:o,csrf_token:e}),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(t=>t.json()).then(t=>t.success?showNotification("Le contenu du a propos a été modifié"):showNotification(t.error)).catch(t=>{showNotification("erreur : "+t),l(!1)}).finally(()=>{r(!1),saveBtn.disabled=!1}))};return useEffect(()=>{const t=t=>{c||(t.preventDefault(),t.returnValue=!0)};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[c]),useEffect(()=>{n(t)},[t]),useEffect(()=>{const t=document.getElementById("saveBtn");return t&&t.addEventListener("click",d),()=>{t&&t.removeEventListener("click",d)}},[o]),React.createElement("div",{className:"font-eudoxus"},React.createElement("label",{htmlFor:"container",className:"flex flex-col gap-2 mb-2 w-full text-sm font-medium"},"contenu du à propos"),React.createElement(QuillEditor,{disabled:s,onChange:u,value:o}),a&&React.createElement("small",{className:"text-red"},a))}