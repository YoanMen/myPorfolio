import React,{useState,useEffect}from"react";import{showConfirmDialog}from"./showConfirmDialog.js";import showNotification from"./showNotification.js";export default function Table({csrf_token:e,data:t,value:a,url:r}){const[o,n]=useState(null);useEffect(()=>(document.addEventListener("click",l),()=>{document.removeEventListener("click",l)}));const l=e=>{null==o||e.target.closest("button")||n(null)},s=e=>{n(o===e?null:e)},c=async t=>{await fetch(`${r}/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({csrf_token:e})}).then(e=>e.json()).then(e=>e.success?window.location.reload():showNotification(e.error)).catch(e=>showNotification("erreur : "+e))},i=e=>{showConfirmDialog({title:"Supprimer cette élément",message:"Êtes-vous sûr de vouloir supprimer cette élément ?",onConfirm:()=>{c(e)},onCancel:()=>{n(null)}})},m=e=>e.map(e=>React.createElement("tr",{key:e.id,className:"h-12 border-b-[1px] border-stroke hover:bg-primary hover:bg-opacity-60 transition-all duration-200 ease-in-out "},u(e),React.createElement("td",{className:"text-center pr-4 relative"},React.createElement("button",{onClick:()=>s(e.id),className:"hover:text-button"},"..."),o===e.id&&React.createElement("div",{className:"absolute bg-primary border-stroke border-[1px] rounded-md right-14 flex flex-col items-start py-2 px-4 gap-1"},React.createElement("a",{href:`${r}/${e.id}`,className:"hover:text-button transition-colors duration-200 ease-in-out"},"modifier"),React.createElement("hr",{className:"border-stroke border-[1px] w-full"}),React.createElement("button",{className:"text-red hover:opacity-80 transition-opacity duration-200 ease-in-out",onClick:()=>i(e.id)},"supprimer"))))),u=e=>{let t=[];for(const r in a)e.hasOwnProperty(r)&&(!0===e[r]||!1===e[r]?t.push(React.createElement("td",{key:r,className:"text-left pl-4 overflow-hidden text-ellipsis"},e[r]?"oui":"non")):t.push(React.createElement("td",{key:r,className:"text-left pl-4 overflow-hidden text-ellipsis"},e[r].length>20?e[r].substring(0,100)+"...":e[r])));return t},d=()=>{let e=[];for(const t in a)e.push(React.createElement("th",{key:t,className:"text-left pl-4"},a[t]));return e};return React.createElement("table",{className:"sm:table-auto table-fixed w-full  rounded-2xl bg-primary font-eudoxus"},React.createElement("thead",{className:"border-b-[1px] border-stroke rounded h-10 w-full"},React.createElement("tr",null,d(),React.createElement("th",{className:"pr-4 w-10"},"actions"))),React.createElement("tbody",{className:"bg-secondary"},m(t)))}