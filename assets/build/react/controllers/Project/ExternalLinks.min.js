import React,{useState,useEffect,useRef}from"react";import SelectItem from"./SelectItem.js";import InputField from"../InputField.js";import{inputValidation}from"../../../../scripts/inputValidation.js";export default function ExternalLink({value:e,onChange:t,selectedLinks:a}){const[n,l]=useState(!1),[r,i]=useState([]),c=useRef(null),[o,u]=useState(""),[s,m]=useState({url:null});useEffect(()=>{d()},[]),useEffect(()=>{if(0!==r.length&&e){let a=[];for(let t of e){const e=r.find(e=>e.id==t.id);if(!e)return;a.push({id:e.id,name:e.name,svg:e.svg,url:t.url})}t(a)}},[r]);const d=async()=>{const e=await fetch("/icons"),t=await e.json();i(t)},f=e=>{const t=[];return e.forEach(e=>{a.find(t=>t.id==e.id)||t.push(React.createElement("option",{value:e.id},e.name))}),0==t.length&&t.push(React.createElement("option",{value:""},"aucune icÃ´ne")),t},p=()=>{if(""==c.current.value)return;const e=inputValidation.link(o.trim());if(e)return;const n=r.find(e=>e.id==c.current.value);t([...a,{id:n.id,name:n.name,svg:n.svg,url:o}])},x=e=>{t(a.filter(t=>t.id!=e))},v=()=>{u(""),m({url:null}),l(!n)},E=e=>{e=e.trim(),m({...s,url:inputValidation.link(e)}),u(e)},R=e=>e.map(e=>React.createElement(SelectItem,{id:e.id,name:e.url,icon:e.svg,onClick:()=>x(e.id)}));return React.createElement("div",null,React.createElement("label",{htmlFor:"container",className:"flex flex-col gap-2 mb-2 w-full text-sm font-medium"},"liens externe"),!n&&React.createElement("button",{onClick:v,className:"hover:text-button"},"+ ajouter un lien externe"),n&&React.createElement("div",{className:"flex gap-4 max-sm:flex-col"},React.createElement("select",{ref:c,name:"externalLink",id:"externalLink",className:"max-w-40 w-full h-10 bg-primary border-stroke border-[1px] rounded-md px-4"},f(r)),React.createElement(InputField,{label:"",id:"name",className:"max-w-80 mb-0",error:s.url,onChange:E,value:o}),React.createElement("div",{className:"flex gap-2 mb-auto mt-2"},React.createElement("button",{className:"hover:text-button  transition-colors duration-200 ease-in-out",onClick:()=>{p(),v()}},"confirmer"),React.createElement("button",{className:"hover:text-button opacity-50 transition-colors duration-200 ease-in-out",onClick:v},"annuler"))),a&&React.createElement("div",{className:"flex flex-wrap w-full gap-2 mt-4"},R(a)))}